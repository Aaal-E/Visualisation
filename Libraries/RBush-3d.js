!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var i;i="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,i.rbush3d=t()}}(function(){return function t(i,n,e){function a(h,o){if(!n[h]){if(!i[h]){var s="function"==typeof require&&require;if(!o&&s)return s(h,!0);if(r)return r(h,!0);var m=new Error("Cannot find module '"+h+"'");throw m.code="MODULE_NOT_FOUND",m}var l=n[h]={exports:{}};i[h][0].call(l.exports,function(t){var n=i[h][1][t];return a(n||t)},l,l.exports,t,i,n,e)}return n[h].exports}for(var r="function"==typeof require&&require,h=0;h<e.length;h++)a(e[h]);return a}({1:[function(t,i,n){"use strict";function e(t,i){if(!(this instanceof e))return new e(t,i);this._maxEntries=Math.max(8,t||16),this._minEntries=Math.max(4,Math.ceil(.4*this._maxEntries)),i&&this._initFormat(i),this.clear()}function a(t,i,n){if(!n)return i.indexOf(t);for(var e=0;e<i.length;e++)if(n(t,i[e]))return e;return-1}function r(t,i){h(t,0,t.children.length,i,t)}function h(t,i,n,e,a){a||(a=M(null)),a.minX=1/0,a.minY=1/0,a.minZ=1/0,a.maxX=-1/0,a.maxY=-1/0,a.maxZ=-1/0;for(var r,h=i;h<n;h++)r=t.children[h],o(a,t.leaf?e(r):r);return a}function o(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.minZ=Math.min(t.minZ,i.minZ),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t.maxZ=Math.max(t.maxZ,i.maxZ),t}function s(t,i){return t.minX-i.minX}function m(t,i){return t.minY-i.minY}function l(t,i){return t.minZ-i.minZ}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)*(t.maxZ-t.minZ)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)+(t.maxZ-t.minZ)}function c(t,i){var n=Math.min(t.minX,i.minX),e=Math.min(t.minY,i.minY),a=Math.min(t.minZ,i.minZ);return(Math.max(t.maxX,i.maxX)-n)*(Math.max(t.maxY,i.maxY)-e)*(Math.max(t.maxZ,i.maxZ)-a)}function x(t,i){var n=Math.max(t.minX,i.minX),e=Math.max(t.minY,i.minY),a=Math.max(t.minZ,i.minZ),r=Math.min(t.maxX,i.maxX),h=Math.min(t.maxY,i.maxY),o=Math.min(t.maxZ,i.maxZ);return Math.max(0,r-n)*Math.max(0,h-e)*Math.max(0,o-a)}function d(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&t.minZ<=i.minZ&&i.maxX<=t.maxX&&i.maxY<=t.maxY&&i.maxZ<=t.maxZ}function p(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.minZ<=t.maxZ&&i.maxX>=t.minX&&i.maxY>=t.minY&&i.maxZ>=t.minZ}function M(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,minZ:1/0,maxX:-1/0,maxY:-1/0,maxZ:-1/0}}function g(t,i,n,e,a){for(var r,h=[i,n];h.length;)n=h.pop(),i=h.pop(),n-i<=e||(r=i+Math.ceil((n-i)/e/2)*e,_(t,r,i,n,a),h.push(i,r,r,n))}i.exports=e,i.exports.default=e;var _=t("quickselect");e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var i=this.data,n=[],e=this.toBBox;if(!p(t,i))return n;for(var a,r,h,o,s=[];i;){for(a=0,r=i.children.length;a<r;a++)h=i.children[a],o=i.leaf?e(h):h,p(t,o)&&(i.leaf?n.push(h):d(t,o)?this._all(h,n):s.push(h));i=s.pop()}return n},collides:function(t){var i=this.data,n=this.toBBox;if(!p(t,i))return!1;for(var e,a,r,h,o=[];i;){for(e=0,a=i.children.length;e<a;e++)if(r=i.children[e],h=i.leaf?n(r):r,p(t,h)){if(i.leaf||d(t,h))return!0;o.push(r)}i=o.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0,n=t.length;i<n;i++)this.insert(t[i]);return this}var e=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){var a=this.data;this.data=e,e=a}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=M([]),this},remove:function(t,i){if(!t)return this;for(var n,e,r,h,o=this.data,s=this.toBBox(t),m=[],l=[];o||m.length;){if(o||(o=m.pop(),e=m[m.length-1],n=l.pop(),h=!0),o.leaf&&-1!==(r=a(t,o.children,i)))return o.children.splice(r,1),m.push(o),this._condense(m),this;h||o.leaf||!d(o,s)?e?(n++,o=e.children[n],h=!1):o=null:(m.push(o),l.push(n),n=0,e=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:s,compareMinY:m,compareMinZ:l,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},_build:function(t,i,n,e){var a,h=n-i+1,o=this._maxEntries;if(h<=o)return a=M(t.slice(i,n+1)),r(a,this.toBBox),a;e||(e=Math.ceil(Math.log(h)/Math.log(o)),o=Math.ceil(h/Math.pow(o,e-1))),a=M([]),a.leaf=!1,a.height=e;var s,m,l,f,u,c,x=Math.ceil(h/o),d=x*Math.ceil(Math.pow(o,2/3)),p=x*Math.ceil(Math.pow(o,1/3));for(g(t,i,n,p,this.compareMinX),s=i;s<=n;s+=p)for(f=Math.min(s+p-1,n),g(t,s,f,d,this.compareMinY),m=s;m<=f;m+=d)for(u=Math.min(m+d-1,f),g(t,m,u,x,this.compareMinZ),l=m;l<=u;l+=x)c=Math.min(l+x-1,u),a.children.push(this._build(t,l,c,e-1));return r(a,this.toBBox),a},_chooseSubtree:function(t,i,n,e){for(var a,r,h,o,s,m,l,u;;){if(e.push(i),i.leaf||e.length-1===n)break;for(l=u=1/0,a=0,r=i.children.length;a<r;a++)h=i.children[a],s=f(h),m=c(t,h)-s,m<u?(u=m,l=s<l?s:l,o=h):m===u&&s<l&&(l=s,o=h);i=o||i.children[0]}return i},_insert:function(t,i,n){var e=this.toBBox,a=n?t:e(t),r=[],h=this._chooseSubtree(a,this.data,i,r);for(h.children.push(t),o(h,a);i>=0&&r[i].children.length>this._maxEntries;)this._split(r,i),i--;this._adjustParentBBoxes(a,r,i)},_split:function(t,i){var n=t[i],e=n.children.length,a=this._minEntries;this._chooseSplitAxis(n,a,e);var h=this._chooseSplitIndex(n,a,e),o=M(n.children.splice(h,n.children.length-h));o.height=n.height,o.leaf=n.leaf,r(n,this.toBBox),r(o,this.toBBox),i?t[i-1].children.push(o):this._splitRoot(n,o)},_splitRoot:function(t,i){this.data=M([t,i]),this.data.height=t.height+1,this.data.leaf=!1,r(this.data,this.toBBox)},_chooseSplitIndex:function(t,i,n){var e,a,r,o,s,m,l,u;for(m=l=1/0,e=i;e<=n-i;e++)a=h(t,0,e,this.toBBox),r=h(t,e,n,this.toBBox),o=x(a,r),s=f(a)+f(r),o<m?(m=o,u=e,l=s<l?s:l):o===m&&s<l&&(l=s,u=e);return u},_chooseSplitAxis:function(t,i,n){var e=t.leaf?this.compareMinX:s,a=t.leaf?this.compareMinY:m,r=t.leaf?this.compareMinZ:l,h=this._allDistMargin(t,i,n,e),o=this._allDistMargin(t,i,n,a),f=this._allDistMargin(t,i,n,r);h<o&&h<f?t.children.sort(e):o<h&&o<f&&t.children.sort(a)},_allDistMargin:function(t,i,n,e){t.children.sort(e);var a,r,s=this.toBBox,m=h(t,0,i,s),l=h(t,n-i,n,s),f=u(m)+u(l);for(a=i;a<n-i;a++)r=t.children[a],o(m,t.leaf?s(r):r),f+=u(m);for(a=n-i-1;a>=i;a--)r=t.children[a],o(l,t.leaf?s(r):r),f+=u(l);return f},_adjustParentBBoxes:function(t,i,n){for(var e=n;e>=0;e--)o(i[e],t)},_condense:function(t){for(var i,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(i=t[n-1].children,i.splice(i.indexOf(t[n]),1)):this.clear():r(t[n],this.toBBox)},_initFormat:function(t){var i=["return a"," - b",";"];this.compareMinX=new Function("a","b",i.join(t[0])),this.compareMinY=new Function("a","b",i.join(t[1])),this.compareMinZ=new Function("a","b",i.join(t[2])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", minZ: a"+t[2]+", maxX: a"+t[3]+", maxY: a"+t[4]+", maxZ: a"+t[5]+"};")}}},{quickselect:2}],2:[function(t,i,n){"use strict";function e(t,i,n,h,o){for(n=n||0,h=h||t.length-1,o=o||r;h>n;){if(h-n>600){var s=h-n+1,m=i-n+1,l=Math.log(s),f=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*f*(s-f)/s)*(m-s/2<0?-1:1);e(t,i,Math.max(n,Math.floor(i-m*f/s+u)),Math.min(h,Math.floor(i+(s-m)*f/s+u)),o)}var c=t[i],x=n,d=h;for(a(t,n,i),o(t[h],c)>0&&a(t,n,h);x<d;){for(a(t,x,d),x++,d--;o(t[x],c)<0;)x++;for(;o(t[d],c)>0;)d--}0===o(t[n],c)?a(t,n,d):(d++,a(t,d,h)),d<=i&&(n=d+1),i<=d&&(h=d-1)}}function a(t,i,n){var e=t[i];t[i]=t[n],t[n]=e}function r(t,i){return t<i?-1:t>i?1:0}i.exports=e},{}]},{},[1])(1)});